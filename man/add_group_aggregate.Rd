% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_aggregate.R
\name{add_group_aggregate}
\alias{add_group_aggregate}
\title{Add subgroup aggregates to a data frame}
\usage{
add_group_aggregate(
  dat,
  grouping,
  vars,
  func = list(mean = function(x) mean(x, na.rm = TRUE))
)
}
\arguments{
\item{dat}{A data.frame containing the columns listed in \code{grouping} and
\code{vars}.}

\item{grouping}{A character vector of one or more column names in \code{dat} that
define the subgroups (their joint combinations). For example, \code{c("sex", "age")} yields aggregates for each \code{sex}-by-\code{age} subgroup.}

\item{vars}{A character vector of column names in \code{dat} to be aggregated.}

\item{func}{A list with named functions applied to each variable in \code{vars}
within each subgroup. Default computes the mean with missing values
removed.}
}
\value{
A data.frame with the same observations as \code{dat}, plus additional
columns containing subgroup-level aggregated values for each variable in
\code{vars}.
}
\description{
Computes summary statistics for selected variables within subgroups defined
by the \emph{combination} of one or more grouping variables (e.g., \code{age} within
\code{sex}) and merges the aggregated values back into the original data.
}
\details{
Aggregation is performed using \code{\link[stats:aggregate]{stats::aggregate()}} with \code{by = dat[, grouping]}, so each unique combination of the \code{grouping} variables defines a
subgroup. Results are joined back to \code{dat} using \code{\link[base:merge]{base::merge()}} by all
\code{grouping} columns. If multiple functions are provided in \code{func}, the
resulting columns are suffixed with the names of the functions in \code{func}. If
\code{func} is an unnamed list, suffixes "stat1", "stat2", etc. are used.
}
\examples{
dat <- data.frame(
  sex = c("f", "f", "m", "m", "m"),
  age = c(10, 10, 10, 12, 12),
  score = c(1, NA, 3, 5, 7),
  other = 1:5
)

# Mean score per subgroup (sex x age), added back to each row
add_group_aggregate(dat, grouping = c("sex", "age"), vars = "score")

# Maximum and median per subgroup
add_group_aggregate(
  dat,
  grouping = c("sex", "age"),
  vars = c("score", "other"),
  func = list(
    max = function(x) max(x, na.rm = TRUE),
    median = function(x) median(x, na.rm = TRUE)
   )
)

}
\seealso{
\code{\link[stats:aggregate]{stats::aggregate()}}, \code{\link[base:merge]{base::merge()}}
}
